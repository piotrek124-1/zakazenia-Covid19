<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dane powiatowe</title>
    <script src="plotly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="bootstrap-4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="bootstrap-4.0.0/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg bg-light">
    <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="index.html" style="color: cornflowerblue">Strona główna</a>
            </li>
            <li class="dropdown">
                <a class="nav-link dropdown-toggle active" role="button" data-toggle="dropdown" style="color: white;background-color: cornflowerblue">Dane powiatowe</a>
                <div class="dropdown-menu">
                    <a href="powiatoweWykres.html" class="dropdown-item">Wykres</a>
                    <a href="powiatoweSrednia.html" class="dropdown-item active">Wykres z średnią 7 dniową</a>
                    <a href="powiatoweProcent.html" class="dropdown-item">% pozytywnych wyników</a>
                </div>
            </li>
            <li class="dropdown">
                <a class="nav-link dropdown-toggle" role="button" data-toggle="dropdown" style="color: cornflowerblue">Dane wojewódzkie</a>
                <div class="dropdown-menu">
                    <a href="wojewodzkieWykres.html" class="dropdown-item">Wykres</a>
                    <a href="wojewodzkieSrednia.html" class="dropdown-item">Wykres z średnią 7 dniową</a>
                    <a href="wojewodzkieProcent.html" class="dropdown-item">% pozytywnych wyników</a>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="ogolnopolskie.html" style="color: cornflowerblue">Dane ogólnopolskie</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="kontakt.html" style="color: cornflowerblue">Kontakt</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="gitHub.html" style="color: cornflowerblue">GitHub</a>
            </li>
        </ul>
    </div>
</nav>
<div id="powiat">
    <label for="powiatSelect">
    </label>
    Powiat/Miasto
    <input multiple type="text" id = "powiatSelect" list="powiatList">
    <label for="powiatSelect2"></label><input multiple type="text" id = "powiatSelect2" list="powiatList">
    <label for="powiatSelect3"></label><input multiple type="text" id = "powiatSelect3" list="powiatList">
    <datalist id = "powiatList"></datalist>
    <script>
        var data = ["Cały kraj","bolesławiecki","dzierżoniowski","głogowski","górowski","jaworski","jeleniogórski","kamiennogórski","kłodzki","legnicki","lubański","lubiński","lwówecki","milicki","oleśnicki","oławski","polkowicki","strzeliński","średzki","świdnicki","trzebnicki","wałbrzyski","wołowski","wrocławski","ząbkowicki","zgorzelecki","złotoryjski","Jelenia Góra","Legnica","Wrocław","Wałbrzych","aleksandrowski","brodnicki","bydgoski","chełmiński","golubsko-dobrzyński","grudziądzki","inowrocławski","lipnowski","mogileński","nakielski","radziejowski","rypiński","sępoleński","świecki","toruński","tucholski","wąbrzeski","włocławski","żniński","Bydgoszcz","Grudziądz","Toruń","Włocławek","bialski","biłgorajski","chełmski","hrubieszowski","janowski","krasnostawski","kraśnicki","lubartowski","lubelski","łęczyński","łukowski","opolski","parczewski","puławski","radzyński","rycki","tomaszowski","włodawski","zamojski","Biała Podlaska","Chełm","Lublin","Zamość","gorzowski","krośnieński","międzyrzecki","nowosolski","słubicki","strzelecko-drezdenecki","sulęciński","świebodziński","zielonogórski","żagański","żarski","wschowski","Gorzów Wielkopolski","Zielona Góra","bełchatowski","kutnowski","łaski","łęczycki","łowicki","łódzki wschodni","opoczyński","pabianicki","pajęczański","piotrkowski","poddębicki","radomszczański","rawski","sieradzki","skierniewicki","wieluński","wieruszowski","zduńskowolski","zgierski","brzeziński","Łódź","Piotrków Trybunalski","Skierniewice","bocheński","brzeski","chrzanowski","dąbrowski","gorlicki","krakowski","limanowski","miechowski","myślenicki","nowosądecki","nowotarski","olkuski","oświęcimski","proszowicki","suski","tarnowski","tatrzański","wadowicki","wielicki","Kraków","Nowy Sącz","Tarnów","białobrzeski","ciechanowski","garwoliński","gostyniński","grodziski","grójecki","kozienicki","legionowski","lipski","łosicki","makowski","miński","mławski","nowodworski","ostrołęcki","ostrowski","otwocki","piaseczyński","płocki","płoński","pruszkowski","przasnyski","przysuski","pułtuski","radomski","siedlecki","sierpecki","sochaczewski","sokołowski","szydłowiecki","warszawski zachodni","węgrowski","wołomiński","wyszkowski","zwoleński","żuromiński","żyrardowski","Ostrołęka","Płock","Radom","Siedlce","Warszawa","głubczycki","kędzierzyńsko-kozielski","kluczborski","krapkowicki","namysłowski","nyski","oleski","prudnicki","strzelecki","Opole","bieszczadzki","brzozowski","dębicki","jarosławski","jasielski","kolbuszowski","leżajski","lubaczowski","łańcucki","mielecki","niżański","przemyski","przeworski","ropczycko-sędziszowski","rzeszowski","sanocki","stalowowolski","strzyżowski","tarnobrzeski","leski","Krosno","Przemyśl","Rzeszów","Tarnobrzeg","augustowski","białostocki","bielski","grajewski","hajnowski","kolneński","łomżyński","moniecki","sejneński","siemiatycki","sokólski","suwalski","wysokomazowiecki","zambrowski","Białystok","Łomża","Suwałki","bytowski","chojnicki","człuchowski","gdański","kartuski","kościerski","kwidzyński","lęborski","malborski","pucki","słupski","starogardzki","tczewski","wejherowski","sztumski","Gdańsk","Gdynia","Słupsk","Sopot","będziński","cieszyński","częstochowski","gliwicki","kłobucki","lubliniecki","mikołowski","myszkowski","pszczyński","raciborski","rybnicki","tarnogórski","bieruńsko-lędziński","wodzisławski","zawierciański","żywiecki","Bielsko-Biała","Bytom","Chorzów","Częstochowa","Dąbrowa Górnicza","Gliwice","Jastrzębie-Zdrój","Jaworzno","Katowice","Mysłowice","Piekary Śląskie","Ruda Śląska","Rybnik","Siemianowice Śląskie","Sosnowiec","Świętochłowice","Tychy","Zabrze","Żory","buski","jędrzejowski","kazimierski","kielecki","konecki","opatowski","ostrowiecki","pińczowski","sandomierski","skarżyski","starachowicki","staszowski","włoszczowski","Kielce","bartoszycki","braniewski","działdowski","elbląski","ełcki","giżycki","iławski","kętrzyński","lidzbarski","mrągowski","nidzicki","nowomiejski","olecki","olsztyński","ostródzki","piski","szczycieński","gołdapski","węgorzewski","Elbląg","Olsztyn","chodzieski","czarnkowsko-trzcianecki","gnieźnieński","gostyński","jarociński","kaliski","kępiński","kolski","koniński","kościański","krotoszyński","leszczyński","międzychodzki","nowotomyski","obornicki","ostrzeszowski","pilski","pleszewski","poznański","rawicki","słupecki","szamotulski","śremski","turecki","wągrowiecki","wolsztyński","wrzesiński","złotowski","Kalisz","Konin","Leszno","Poznań","białogardzki","choszczeński","drawski","goleniowski","gryficki","gryfiński","kamieński","kołobrzeski","koszaliński","myśliborski","policki","pyrzycki","sławieński","stargardzki","szczecinecki","świdwiński","wałecki","łobeski","Koszalin","Szczecin","Świnoujście"]
        var newPowiat = document.getElementById("powiatList")
        for (i in data) {
            newPowiat = document.getElementById("powiatList").appendChild(document.createElement("option"))
            newPowiat.value = data[i]
        }
        newPowiat = document.getElementById("powiatSelect")
        newPowiat.addEventListener("input", plot)
        document.getElementById("powiatSelect2").addEventListener("input", plot)
        document.getElementById("powiatSelect3").addEventListener("input", plot)
        var csv = false
        if (csv === false) {
            csvData = Plotly.d3.csv("https://raw.githubusercontent.com/piotrek124-1/zakazenia-Covid19/main/plotData/powiaty_zakazenia.csv", function (error, data) {
                plotCsvData = data
                csv = true
            })
        }
        var plotCsvData = []
        var liczbaPrzypadkow = [], stan_rekordu_na = [], powiatName
        function plot() {
            function activePowiat(powiat) {
                liczbaPrzypadkow = []
                stan_rekordu_na = []
                var sum = 0
                var j = 0
                var index = []
                for (i in plotCsvData) {
                    if (plotCsvData[i]["powiat_miasto"] === powiat) {
                        index.push(i)
                        sum += Number(plotCsvData[i]["liczba_przypadkow"])
                        if (j > 5) {
                            liczbaPrzypadkow.push(sum / 7)
                            stan_rekordu_na.push(plotCsvData[i]["stan_rekordu_na"])
                            sum -= Number(plotCsvData[index[0]]["liczba_przypadkow"])
                            index.shift()
                            console.log(index)
                        }
                        j++
                    }
                }
                powiatName = powiat
            }
            activePowiat(document.getElementById("powiatSelect").value)
            var trace = {
                x: stan_rekordu_na,
                y: liczbaPrzypadkow,
                mode: "lines",
                name: powiatName
            }
            activePowiat(document.getElementById("powiatSelect2").value)
            var trace2 = {
                x: stan_rekordu_na,
                y: liczbaPrzypadkow,
                mode: "lines",
                name: powiatName
            }
            activePowiat(document.getElementById("powiatSelect3").value)
            var trace3 = {
                x: stan_rekordu_na,
                y: liczbaPrzypadkow,
                mode: "lines",
                name: powiatName
            }
            var layout = {
                title: "Wykres zakażeń Covid-19",
                xaxis: {
                    title: "data",
                    tickvals: stan_rekordu_na,
                    tickformat: "%d/%m"
                }, yaxis: {
                    title: "Liczba przypadków"
                }
            }
            var plotData = [trace, trace2, trace3]
            Plotly.newPlot("plot", plotData, layout)
        }
    </script>
</div>
<div id="plot"></div>
<div>
    Źródło danych:
    <a href= "https://gov.pl/">https://gov.pl/</a>
</div></body>
</html>